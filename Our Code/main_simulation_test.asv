%% Robot Test Script

clear
clc
close all

%define robot information 
range = 500;
ns = 10;

%initial positon
rpos = [710, 90, pi/2];
goalSighted = [0, 0];
goalReached = 0;

%goal locations
goal_1 = [721, 60];
goal_2 = [1340, 680]; 
robot_goal = goal_1;

%map definition 
[grid_map, rgb] = imread('course_bw.png');

%plot robot
draw_bot(rpos, grid_map, rgb);
drawnow;

%% Robot Moving Loop

while ~goalReached
    
    [sonarDist, goalSighted, goalReached] = sonarMeasure2(grid_map, rpos, ns, range);
    
    dist_to_goal(1) = sqrt((rpos(2) - robot_goal(2))^2 + (rpos(1) - robot_goal(1))^2);
    dist_to_goal(2) = atan2((rpos(2) - robot_goal(2),i-rx);
    
    alpha_r = rebound_angle(sonarDist, ns, rpos);
    
%     if goalSighted(1) ==1 || goalSighted(1) == 2
%         alpha_r = goalSighted(2);
%         goalSighted(:) = 0; 
%     end
    
    
    rpos = Rotate(rpos, alpha_r, grid_map, rgb);
    rpos =  drive(rpos, grid_map, rgb);
    
end

